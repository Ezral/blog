<!doctype html><html lang="en"><head><meta charset="utf-8"> <title>Spam Filter with Naive Bayes - Ezral</title> <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"> <meta name="description" content="This is a Dataquest guided project originally written on this jupyter notebook file Background Have you ever felt disturbed by spam messages? I’m sure everybody has. Even those who sent the spam messages have. Fortunately there’s this thing called spam..."> <meta name="theme-color" content="#1E2127"> <link rel="alternate" href="/feed.xml" type="application/atom+xml"> <link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.png" type="image/png"><link rel="icon" href="data:image/svg+xml;utf8,%3Csvg%20id%3D'Layer_1'%20data-name%3D'Layer%201'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%20700%20700'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill%3A%23e1fff9%3B%7D.cls-2%7Bfill%3A%235ec1c9%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3EstickerArtboard%201%3C%2Ftitle%3E%3Cpath%20class%3D'cls-1'%20d%3D'M286.88%2C78.88A224.63%2C224.63%2C0%2C0%2C0%2C254%2C81.28a194.18%2C194.18%2C0%2C0%2C0-57.48%2C17.9c-22.38%2C11-42.47%2C26.17-61.41%2C46.23-18.24%2C19.3-32.21%2C40.58-41.52%2C63.23a200.23%2C200.23%2C0%2C0%2C0-14.74%2C76.42q0%2C35.76%2C0%2C71.53%2C0%2C28.13%2C0%2C56.25a221%2C221%2C0%2C0%2C0%2C2.92%2C36.05%2C193.34%2C193.34%2C0%2C0%2C0%2C19.28%2C57.74c10.73%2C20.58%2C24.94%2C39.21%2C43.45%2C57%2C40.35%2C38.71%2C87.1%2C57.52%2C142.92%2C57.52%2C1.44%2C0%2C2.9%2C0%2C4.36%2C0%2C17.62-.31%2C36.22-.47%2C55.27-.47%2C19.35%2C0%2C39.3.15%2C61%2C.48l3.83%2C0a228.58%2C228.58%2C0%2C0%2C0%2C35.92-2.76%2C192.25%2C192.25%2C0%2C0%2C0%2C67.25-24c22-12.88%2C42-30.19%2C59.64-51.47%2C30.61-37%2C46.2-80.16%2C46.33-128.27.14-51.08.11-103%2C.08-153.26l0-56.59H584V241c0%2C56.38%2C0%2C114.68%2C0%2C172a197.79%2C197.79%2C0%2C0%2C1-1.13%2C20.46%2C155.7%2C155.7%2C0%2C0%2C1-19.54%2C60.84c-10%2C17.69-23.12%2C33.37-40.09%2C47.93-31.77%2C27.27-69%2C41.1-110.62%2C41.1h-.21l-35.7%2C0H338.72q-25.26%2C0-50.52%2C0c-6%2C0-12.44-.32-19.71-.95a157.53%2C157.53%2C0%2C0%2C1-43-10c-22.81-8.77-43.68-23-62-42.24-32.54-34.15-48.57-75.29-47.63-122.3.71-36%2C1.22-74.69.08-113.92a194.1%2C194.1%2C0%2C0%2C1%2C2-34.48%2C158.34%2C158.34%2C0%2C0%2C1%2C18-53.1c10.33-18.67%2C24.07-35.12%2C42-50.28%2C31.22-26.4%2C67.43-39.9%2C107.63-40.11%2C15.15-.08%2C31.63-.12%2C50.39-.12q26.7%2C0%2C53.4.07l23.57%2C0a64.07%2C64.07%2C0%2C0%2C1%2C12.56%2C1.25c16.33%2C3.28%2C27.22%2C13.92%2C30.67%2C30a62.23%2C62.23%2C0%2C0%2C1%2C1.37%2C12.68c.1%2C22.55.07%2C45.33%2C0%2C64.62a65%2C65%2C0%2C0%2C1-.8%2C9.92%2C39.51%2C39.51%2C0%2C0%2C1-31.11%2C32.59A69.54%2C69.54%2C0%2C0%2C1%2C412%2C268.16c-48.07.09-95.18.17-134.3.22a72.52%2C72.52%2C0%2C0%2C0-72.32%2C72.43c0%2C15.39%2C0%2C30.16%2C0%2C41.58a108.16%2C108.16%2C0%2C0%2C0%2C8.07%2C41.29c5.84%2C14.17%2C14.64%2C26.89%2C26.88%2C38.88%2C22%2C21.51%2C47.42%2C32%2C77.73%2C32.05q15.3%2C0%2C30.6%2C0c11.57%2C0%2C21.79%2C0%2C31.26-.07%2C4.13%2C0%2C8.32-.2%2C12.45-.53A102.9%2C102.9%2C0%2C0%2C0%2C432.15%2C483c18.44-9.65%2C34-24.08%2C47.43-44.13%2C14.78-22%2C18.67-45.7%2C11.89-72.53A43.47%2C43.47%2C0%2C0%2C0%2C480%2C345.48a44.8%2C44.8%2C0%2C0%2C0-20.21-11.35c-3.25-.91-6.7-1.61-10.34-2.35-1.76-.36-3.52-.72-5.27-1.1l.35-25.39.87-.17c.85-.17%2C1.75-.35%2C2.65-.5A80.12%2C80.12%2C0%2C0%2C0%2C470.46%2C298c9.05-4.38%2C15.35-10.39%2C19.26-18.37a50.29%2C50.29%2C0%2C0%2C0%2C4.83-22.44c.08-38.55.08-79.8%2C0-129.81A46.67%2C46.67%2C0%2C0%2C0%2C490.8%2C109%2C50.13%2C50.13%2C0%2C0%2C0%2C445.34%2C78.9l-57.21%2C0H287l-.09-13Z'%2F%3E%3Ccircle%20class%3D'cls-1'%20cx%3D'350'%20cy%3D'350'%20r%3D'326.72'%2F%3E%3Cpath%20class%3D'cls-2'%20d%3D'M382%2C318.16c-41.3.11-82.59%2C0-123.89%2C0-.85%2C0-1.69.08-2.69.12-.05.93-.13%2C1.69-.14%2C2.44%2C0%2C20.22-.08%2C40.44%2C0%2C60.65a60.69%2C60.69%2C0%2C0%2C0%2C14.71%2C40c12.89%2C15.24%2C29.07%2C23.4%2C49.31%2C23.22%2C20.74-.18%2C41.47-.05%2C62.21%2C0a69.08%2C69.08%2C0%2C0%2C0%2C14.4-1.48c26.84-5.71%2C57.1-35.34%2C46.67-78.28C437.59%2C344.25%2C415.54%2C318.07%2C382%2C318.16Z'%2F%3E%3Cpath%20class%3D'cls-2'%20d%3D'M409.54%2C10C172.57-29.62-29.62%2C172.57%2C10%2C409.54%2C34%2C553%2C147%2C666%2C290.46%2C690c237%2C39.61%2C439.16-162.58%2C399.55-399.55C666%2C147%2C553%2C34%2C409.54%2C10ZM584.69%2C551.11c-17.94%2C21.68-38.73%2C40.12-63.07%2C54.39a204.51%2C204.51%2C0%2C0%2C1-71.76%2C25.65%2C242.74%2C242.74%2C0%2C0%2C1-42%2C2.9c-38.62-.58-77.24-.7-115.85%2C0Q200.83%2C635.67%2C135.54%2C573c-18.47-17.71-34.11-37.58-46-60.33A204.92%2C204.92%2C0%2C0%2C1%2C69%2C451a232.42%2C232.42%2C0%2C0%2C1-3.1-38.17q0-63.9%2C0-127.79a212.18%2C212.18%2C0%2C0%2C1%2C15.71-81.34c10.37-25.23%2C25.4-47.42%2C44.08-67.2%2C18.92-20%2C40.33-36.72%2C65.11-48.95a205.91%2C205.91%2C0%2C0%2C1%2C61.3-19.1A235%2C235%2C0%2C0%2C1%2C287%2C65.92q79.2%2C0%2C158.38%2C0a62.91%2C62.91%2C0%2C0%2C1%2C57.36%2C38%2C59.34%2C59.34%2C0%2C0%2C1%2C4.81%2C23.44q.09%2C64.92%2C0%2C129.86a63.41%2C63.41%2C0%2C0%2C1-6.15%2C28.11c-5.47%2C11.16-14.18%2C19-25.25%2C24.34a93.47%2C93.47%2C0%2C0%2C1-26%2C7.76c-1.09.17-2.18.41-3.17.6%2C5.43%2C1.19%2C10.95%2C2.13%2C16.32%2C3.63a58%2C58%2C0%2C0%2C1%2C25.87%2C14.64A56.56%2C56.56%2C0%2C0%2C1%2C504%2C363.15c7.48%2C29.61%2C3.48%2C57.41-13.69%2C83C476.82%2C466.2%2C460%2C483%2C438.16%2C494.47A116.29%2C116.29%2C0%2C0%2C1%2C393.41%2C507q-6.71.54-13.43.57c-20.65.1-41.3.07-62%2C0-33.79-.06-62.65-12.16-86.76-35.75-12.74-12.47-23-26.66-29.8-43.21a120.46%2C120.46%2C0%2C0%2C1-9.05-46.21c0-11.42%2C0-26.19%2C0-41.59a85.37%2C85.37%2C0%2C0%2C1%2C85.26-85.39c39.12%2C0%2C86.23-.13%2C134.31-.22a57%2C57%2C0%2C0%2C0%2C11.06-1%2C26.44%2C26.44%2C0%2C0%2C0%2C20.83-21.88%2C51.67%2C51.67%2C0%2C0%2C0%2C.65-8c.05-21.51.08-43%2C0-64.54a48.17%2C48.17%2C0%2C0%2C0-1.09-10c-2.39-11.15-9.46-17.75-20.54-20a51.14%2C51.14%2C0%2C0%2C0-10-1c-42.42-.07-84.85-.22-127.27%2C0-37.56.2-70.66%2C12.8-99.33%2C37-15.71%2C13.28-29%2C28.59-39%2C46.65a144.68%2C144.68%2C0%2C0%2C0-16.52%2C48.78%2C179.13%2C179.13%2C0%2C0%2C0-1.84%2C32.16c1.11%2C38.17.68%2C76.36-.08%2C114.55-.88%2C44%2C14%2C81.55%2C44%2C113.09%2C16.31%2C17.13%2C35.14%2C30.57%2C57.31%2C39.09a143.77%2C143.77%2C0%2C0%2C0%2C39.47%2C9.21c6.19.53%2C12.41.89%2C18.62.9%2C41.39.08%2C82.77%2C0%2C124.16%2C0%2C38.85%2C0%2C72.93-12.71%2C102.37-38C529.62%2C519.63%2C542.32%2C505%2C552%2C487.92a142.3%2C142.3%2C0%2C0%2C0%2C17.93-55.8A185.34%2C185.34%2C0%2C0%2C0%2C571%2C413q.1-108.87%2C0-217.73v-3.49h62.74c.09.61.22%2C1.17.25%2C1.75%2C0%2C.77%2C0%2C1.55%2C0%2C2.33%2C0%2C72.92.15%2C145.84%2C0%2C218.77C633.85%2C465.92%2C617.44%2C511.52%2C584.69%2C551.11Z'%2F%3E%3C%2Fsvg%3E" sizes="any" type="image/svg+xml"><link rel="mask-icon" href="/mask-icon.svg" color="#1E2127"> <link rel="manifest" href="/manifest.json"> <style>:root{--fontstack-prefix:-apple-system,BlinkMacSystemFont,;--fontstack-sans-serif:"Helvetica Neue","Segoe UI",sans-serif;--fontstack-serif:Georgia,serif;--fontstack-monospace:Menlo,Consolas,monospace;--fontstack-default:var(--fontstack-prefix) var(--fontstack-sans-serif);--font-size-base:1rem;--font-size-factor:1vw;--font-size:1.6vw;--font-features:"halt","ss01","ss02";--line-height:calc(20 / 14);--heading-letter-spacing:-.04em;--breakpoint-lg:1600px;--breakpoint-md:1080px;--breakpoint-sm:640px;--breakpoint-xs:400px;--space-lg:24vw;--space-md:8vw;--space-sm:4vw;--space-xs:1.2vw;--border-lg:4px;--border-md:2px;--border-sm:1px;--nav-padding:.75vmax;--nav-item-space:1.4vmax;--text-color-h:318;--text-color-s:30%;--text-color-l:10%;--text-color-hsl:var(--text-color-h),var(--text-color-s),var(--text-color-l);--text-color:hsl(var(--text-color-hsl));--text-color-0:hsla(var(--text-color-hsl), 0);--text-color-3:hsla(var(--text-color-hsl), .03);--text-color-5:hsla(var(--text-color-hsl), .05);--text-color-7:hsla(var(--text-color-hsl), .07);--text-color-10:hsla(var(--text-color-hsl), .1);--text-color-20:hsla(var(--text-color-hsl), .2);--text-color-30:hsla(var(--text-color-hsl), .3);--text-color-40:hsla(var(--text-color-hsl), .4);--text-color-50:hsla(var(--text-color-hsl), .5);--text-color-60:hsla(var(--text-color-hsl), .6);--text-color-70:hsla(var(--text-color-hsl), .7);--text-color-80:hsla(var(--text-color-hsl), .8);--text-color-90:hsla(var(--text-color-hsl), .9);--text-color-light:hsl(var(--text-color-h), var(--text-color-s), calc(var(--text-color-l) / .9));--text-color-dark:hsl(var(--text-color-h), var(--text-color-s), calc(var(--text-color-l) * .9));--link-color-h:318;--link-color-s:100%;--link-color-l:50%;--link-color-hsl:var(--link-color-h),var(--link-color-s),var(--link-color-l);--link-color:hsl(var(--link-color-hsl));--link-color-0:hsla(var(--link-color-hsl), 0);--link-color-3:hsla(var(--link-color-hsl), .03);--link-color-5:hsla(var(--link-color-hsl), .05);--link-color-7:hsla(var(--link-color-hsl), .07);--link-color-10:hsla(var(--link-color-hsl), .1);--link-color-20:hsla(var(--link-color-hsl), .2);--link-color-30:hsla(var(--link-color-hsl), .3);--link-color-40:hsla(var(--link-color-hsl), .4);--link-color-50:hsla(var(--link-color-hsl), .5);--link-color-60:hsla(var(--link-color-hsl), .6);--link-color-70:hsla(var(--link-color-hsl), .7);--link-color-80:hsla(var(--link-color-hsl), .8);--link-color-90:hsla(var(--link-color-hsl), .9);--link-color-light:hsl(var(--link-color-h), var(--link-color-s), calc(var(--link-color-l) / .9));--link-color-dark:hsl(var(--link-color-h), var(--link-color-s), calc(var(--link-color-l) * .9));--bg-color-h:318;--bg-color-s:30%;--bg-color-l:100%;--bg-color-hsl:var(--bg-color-h),var(--bg-color-s),var(--bg-color-l);--bg-color:hsl(var(--bg-color-hsl));--bg-color-0:hsla(var(--bg-color-hsl), 0);--bg-color-3:hsla(var(--bg-color-hsl), .03);--bg-color-5:hsla(var(--bg-color-hsl), .05);--bg-color-7:hsla(var(--bg-color-hsl), .07);--bg-color-10:hsla(var(--bg-color-hsl), .1);--bg-color-20:hsla(var(--bg-color-hsl), .2);--bg-color-30:hsla(var(--bg-color-hsl), .3);--bg-color-40:hsla(var(--bg-color-hsl), .4);--bg-color-50:hsla(var(--bg-color-hsl), .5);--bg-color-60:hsla(var(--bg-color-hsl), .6);--bg-color-70:hsla(var(--bg-color-hsl), .7);--bg-color-80:hsla(var(--bg-color-hsl), .8);--bg-color-90:hsla(var(--bg-color-hsl), .9);--bg-color-light:hsl(var(--bg-color-h), var(--bg-color-s), calc(var(--bg-color-l) / .9));--bg-color-dark:hsl(var(--bg-color-h), var(--bg-color-s), calc(var(--bg-color-l) * .9));--code-color-h:calc(var(--link-color-h) + 30);--code-color-s:calc(var(--link-color-s) * .2 + 30%);--code-color-l:var(--link-color-l);--code-color-hsl:var(--code-color-h),var(--code-color-s),var(--code-color-l);--code-color:hsl(var(--code-color-hsl));--code-color-0:hsla(var(--code-color-hsl), 0);--code-color-3:hsla(var(--code-color-hsl), .03);--code-color-5:hsla(var(--code-color-hsl), .05);--code-color-7:hsla(var(--code-color-hsl), .07);--code-color-10:hsla(var(--code-color-hsl), .1);--code-color-20:hsla(var(--code-color-hsl), .2);--code-color-30:hsla(var(--code-color-hsl), .3);--code-color-40:hsla(var(--code-color-hsl), .4);--code-color-50:hsla(var(--code-color-hsl), .5);--code-color-60:hsla(var(--code-color-hsl), .6);--code-color-70:hsla(var(--code-color-hsl), .7);--code-color-80:hsla(var(--code-color-hsl), .8);--code-color-90:hsla(var(--code-color-hsl), .9);--code-color-light:hsl(var(--code-color-h), var(--code-color-s), calc(var(--code-color-l) / .9));--code-color-dark:hsl(var(--code-color-h), var(--code-color-s), calc(var(--code-color-l) * .9))}*,::after,::before{padding:0;margin:0;box-sizing:border-box}html{font-size:100%;-webkit-text-size-adjust:none;-moz-text-size-adjust:none;-ms-text-size-adjust:none;text-size-adjust:none;text-rendering:optimizelegibility;image-rendering:optimizequality;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:var(--bg-color)}body{--space-body:var(--space-lg);padding-top:0;padding-bottom:0;padding-left:var(--space-body);padding-right:var(--space-body);margin:0 auto 0;font-family:var(--fontstack-default);font-size:var(--font-size);font-feature-settings:var(--font-features);line-height:var(--line-height);hanging-punctuation:first allow-end;color:var(--text-color);background:var(--bg-color);transition:all .2s ease}@media (max-width:1080px){body{--space-body:var(--space-md);font-size:calc(var(--font-size) * 1.4)}}@media (max-width:640px){body{--space-body:var(--space-sm);font-size:calc(var(--font-size) * 2.4)}}@media (max-width:400px){body{font-size:calc(var(--font-size) * 3.2)}}a{color:var(--text-color);text-decoration:none;transition:color .5s ease,border-color .5s ease,background .5s ease,opacity 1.5s ease}a:focus,a:hover{transition:color .1s ease,border-color .1s ease,background .1s ease,opacity .1s ease;text-decoration:underline}hr{border:0}::-webkit-input-placeholder{color:var(--text-color);opacity:.2}:-ms-input-placeholder{color:var(--text-color);opacity:.2}::-ms-input-placeholder{color:var(--text-color);opacity:.2}:focus::-webkit-input-placeholder{color:var(--link-color)}:focus:-ms-input-placeholder{color:var(--link-color)}:focus::-ms-input-placeholder{color:var(--link-color)}.navigation{padding-top:var(--nav-padding);padding-bottom:var(--nav-padding);margin-right:calc(var(--nav-item-space) * -1);margin-left:calc(var(--nav-item-space) * -1);font-size:90%;font-weight:700}.navigation li{display:inline-block;line-height:2}.navigation li a{padding:.5em var(--nav-item-space)}.navigation li a:focus,.navigation li a:hover{color:var(--link-color);text-decoration:none}.current a{color:var(--link-color)}.content{margin-bottom:16vmin}.content::after,.content::before{display:table;content:""}.content::after{clear:both}.content article>:last-child{margin-bottom:0!important}.content article>:last-child>:last-child{margin-bottom:0!important}.content article>:last-child>:last-child>:last-child{margin-bottom:0!important}.content article>:last-child>:last-child>:last-child>:last-child{margin-bottom:0!important}.content .post-content>:first-child{margin-top:0}.content .post-content>:first-child>:first-child{margin-top:0}.content a{font-weight:700}.content a:has(>code){-webkit-text-decoration-color:var(--code-color);text-decoration-color:var(--code-color)}.content p{margin-bottom:1.6rem;line-height:calc(var(--line-height) * 1.2)}.content header{--header-height:100vh;--space-header:var(--space-lg);display:flex;min-height:calc(var(--header-height) - (var(--nav-padding) * 4) - (var(--nav-item-space) * 4) - (1ex * .9 * 2));padding-top:10vmin;padding-bottom:10vmin;margin-bottom:16vmin;flex-direction:column;justify-content:center;background:var(--text-color-3);padding-left:var(--space-header);padding-right:var(--space-header);margin-left:calc(var(--space-header) * -1);margin-right:calc(var(--space-header) * -1)}@media (max-width:1080px){.content header{--header-height:70vh;--space-header:var(--space-md);padding-top:16vmin;padding-bottom:16vmin}}@media (max-width:640px){.content header{--space-header:var(--space-sm)}}.content header h1{font-size:360%;font-weight:700;letter-spacing:var(--heading-letter-spacing);margin-left:-2px;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.1}@media (max-width:640px){.content header h1{font-size:280%}}.content header small{display:block;margin-top:2vmin}.content h2,.content h6{margin:10vmin 0 1rem;font-size:72%;font-weight:400;opacity:.5}.content ul{margin-bottom:1.8rem;list-style:none;counter-reset:list}@media (max-width:640px){.content ul{margin-left:1em}}.content ul li{line-height:calc(var(--line-height) * 1.2)}.content ul li::before{position:absolute;display:flex;justify-content:flex-end;width:4em;margin-top:0;margin-left:-4em;text-align:right;opacity:.4;pointer-events:none}.content ul li::before{content:"-";padding-right:.5em}.content hr::before{display:block;content:'';width:3px;height:3px;margin:2em auto;border-radius:50%;background:var(--text-color);box-shadow:24px 0 0 0 var(--text-color),-24px 0 0 0 var(--text-color)}.content code,.content pre{font-family:var(--fontstack-monospace);color:var(--code-color)}.content pre{background:var(--code-color-5)}.content code{font-size:92%;overflow-wrap:break-word}.content .highlight>pre,.content .highlighter-rouge pre.highlight,.content pre{--space-code:var(--space-xs);padding-top:var(--space-xs);padding-bottom:var(--space-xs);padding-left:var(--space-code);padding-right:var(--space-code);margin-left:calc(var(--space-code) * -1);margin-right:calc(var(--space-code) * -1);margin-bottom:1.8rem;overflow-x:auto;font-size:80%;line-height:calc(var(--line-height) * 1.2);-webkit-overflow-scrolling:touch}@media (max-width:1080px){.content .highlight>pre,.content .highlighter-rouge pre.highlight,.content pre{--space-code:var(--space-md)}}@media (max-width:640px){.content .highlight>pre,.content .highlighter-rouge pre.highlight,.content pre{--space-code:var(--space-sm)}}.content .highlight>pre code,.content .highlighter-rouge pre.highlight code,.content pre code{overflow-wrap:normal}.post-modified-date{font-size:75%;opacity:.5}.footer{padding:0 0 16vmin;margin-right:calc(var(--nav-item-space) * -1);margin-left:calc(var(--nav-item-space) * -1);font-size:80%;text-transform:lowercase}@media print{*,::after,::before{background:0 0!important;color:#000!important;box-shadow:none!important;text-shadow:none!important}body{padding:10mm!important;margin:0!important;font-size:calc(var(--font-size) * 1.35)}a,a:visited{text-decoration:none}.content header{min-height:0;padding-bottom:0}.content .post-content{max-width:100%!important}.content .post-content a[href]::after{content:" (" attr(href) ")";font-weight:400;opacity:.5}.content .post-content a[href^="#"]::after{content:""}pre{page-break-inside:avoid}h2,h6,p{orphans:3;widows:3}h2{page-break-after:avoid}.footer,.navigation{display:none}}:root{--rdmz-h:var(--code-color-h, 254);--rdmz-s:var(--code-color-s, 80%);--rdmz-l:var(--code-color-l, 39%)}.highlight>pre,.highlighter-rouge pre.highlight{background:hsla(var(--rdmz-h),var(--rdmz-s),var(--rdmz-l),.03)}.highlight .c1,.highlighter-rouge .c1{font-style:italic}.highlight .nf,.highlighter-rouge .nf{font-weight:700}.highlight .o,.highlighter-rouge .o{font-weight:700}.highlight .ow,.highlighter-rouge .ow{font-weight:700}.highlight .k,.highlighter-rouge .k{font-weight:700}.highlight code,.highlight pre,.highlighter-rouge code,.highlighter-rouge pre{--rdmz-h-local:var(--rdmz-h);color:hsl(var(--rdmz-h),var(--rdmz-s),var(--rdmz-l))}.highlight .n,.highlighter-rouge .n{--rdmz-h-local:calc(var(--rdmz-h) + 16.1194029851);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .nb,.highlighter-rouge .nb{--rdmz-h-local:calc(var(--rdmz-h) + 26.8656716418);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .bp,.highlighter-rouge .bp{--rdmz-h-local:calc(var(--rdmz-h) + 32.2388059701);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .nf,.highlighter-rouge .nf{--rdmz-h-local:calc(var(--rdmz-h) + 64.4776119403);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .nn,.highlighter-rouge .nn{--rdmz-h-local:calc(var(--rdmz-h) + 75.223880597);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .k,.highlighter-rouge .k{--rdmz-h-local:calc(var(--rdmz-h) + 177.313432836);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .kn,.highlighter-rouge .kn{--rdmz-h-local:calc(var(--rdmz-h) + 193.432835821);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .s,.highlighter-rouge .s{--rdmz-h-local:calc(var(--rdmz-h) + 236.417910448);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .se,.highlighter-rouge .se{--rdmz-h-local:calc(var(--rdmz-h) + 263.28358209);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .mf,.highlighter-rouge .mf{--rdmz-h-local:calc(var(--rdmz-h) + 306.268656716);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .mi,.highlighter-rouge .mi{--rdmz-h-local:calc(var(--rdmz-h) + 317.014925373);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .o,.highlighter-rouge .o{--rdmz-h-local:calc(var(--rdmz-h) + 343.880597015);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .ow,.highlighter-rouge .ow{--rdmz-h-local:calc(var(--rdmz-h) + 349.253731343);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .p,.highlighter-rouge .p{--rdmz-h-local:calc(var(--rdmz-h) + 354.626865672);color:hsl(var(--rdmz-h-local),var(--rdmz-s),var(--rdmz-l))}.highlight .c1,.highlighter-rouge .c1{color:hsla(calc(var(--rdmz-h) + 26.8656716418),calc(var(--rdmz-s) * .7),var(--rdmz-l),.6)}h1{font-size:250%;opacity:.9}.content h2{font-size:200%;opacity:.8;margin:10vmin 0 1rem}.content h6{font-size:80%;opacity:.6}.content li{margin-left:40px}:root{--fontstack-prefix:-apple-system,BlinkMacSystemFont,;--fontstack-sans-serif:"Helvetica Neue","Segoe UI",sans-serif;--fontstack-serif:Georgia,serif;--fontstack-monospace:Menlo,Consolas,monospace;--fontstack-default:var(--fontstack-prefix) var(--fontstack-sans-serif);--font-size-base:1rem;--font-size-factor:1vw;--font-size:1.5vw;--font-features:"halt","ss01","ss02";--line-height:calc(20 / 14);--heading-letter-spacing:-.04em;--breakpoint-lg:1600px;--breakpoint-md:1080px;--breakpoint-sm:640px;--breakpoint-xs:400px;--space-lg:24vw;--space-md:8vw;--space-sm:4vw;--space-xs:1.2vw;--border-lg:4px;--border-md:2px;--border-sm:1px;--nav-padding:.75vmax;--nav-item-space:1.4vmax;--text-color-h:318;--text-color-s:30%;--text-color-l:10%;--text-color-hsl:var(--text-color-h),var(--text-color-s),var(--text-color-l);--text-color:hsl(var(--text-color-hsl));--text-color-0:hsla(var(--text-color-hsl), 0);--text-color-3:hsla(var(--text-color-hsl), .03);--text-color-5:hsla(var(--text-color-hsl), .05);--text-color-7:hsla(var(--text-color-hsl), .07);--text-color-10:hsla(var(--text-color-hsl), .1);--text-color-20:hsla(var(--text-color-hsl), .2);--text-color-30:hsla(var(--text-color-hsl), .3);--text-color-40:hsla(var(--text-color-hsl), .4);--text-color-50:hsla(var(--text-color-hsl), .5);--text-color-60:hsla(var(--text-color-hsl), .6);--text-color-70:hsla(var(--text-color-hsl), .7);--text-color-80:hsla(var(--text-color-hsl), .8);--text-color-90:hsla(var(--text-color-hsl), .9);--text-color-light:hsl(var(--text-color-h), var(--text-color-s), calc(var(--text-color-l) / .9));--text-color-dark:hsl(var(--text-color-h), var(--text-color-s), calc(var(--text-color-l) * .9));--link-color-h:175;--link-color-s:80%;--link-color-l:50%;--link-color-hsl:var(--link-color-h),var(--link-color-s),var(--link-color-l);--link-color:hsl(var(--link-color-hsl));--link-color-0:hsla(var(--link-color-hsl), 0);--link-color-3:hsla(var(--link-color-hsl), .03);--link-color-5:hsla(var(--link-color-hsl), .05);--link-color-7:hsla(var(--link-color-hsl), .07);--link-color-10:hsla(var(--link-color-hsl), .1);--link-color-20:hsla(var(--link-color-hsl), .2);--link-color-30:hsla(var(--link-color-hsl), .3);--link-color-40:hsla(var(--link-color-hsl), .4);--link-color-50:hsla(var(--link-color-hsl), .5);--link-color-60:hsla(var(--link-color-hsl), .6);--link-color-70:hsla(var(--link-color-hsl), .7);--link-color-80:hsla(var(--link-color-hsl), .8);--link-color-90:hsla(var(--link-color-hsl), .9);--link-color-light:hsl(var(--link-color-h), var(--link-color-s), calc(var(--link-color-l) / .9));--link-color-dark:hsl(var(--link-color-h), var(--link-color-s), calc(var(--link-color-l) * .9));--bg-color-h:318;--bg-color-s:30%;--bg-color-l:100%;--bg-color-hsl:var(--bg-color-h),var(--bg-color-s),var(--bg-color-l);--bg-color:hsl(var(--bg-color-hsl));--bg-color-0:hsla(var(--bg-color-hsl), 0);--bg-color-3:hsla(var(--bg-color-hsl), .03);--bg-color-5:hsla(var(--bg-color-hsl), .05);--bg-color-7:hsla(var(--bg-color-hsl), .07);--bg-color-10:hsla(var(--bg-color-hsl), .1);--bg-color-20:hsla(var(--bg-color-hsl), .2);--bg-color-30:hsla(var(--bg-color-hsl), .3);--bg-color-40:hsla(var(--bg-color-hsl), .4);--bg-color-50:hsla(var(--bg-color-hsl), .5);--bg-color-60:hsla(var(--bg-color-hsl), .6);--bg-color-70:hsla(var(--bg-color-hsl), .7);--bg-color-80:hsla(var(--bg-color-hsl), .8);--bg-color-90:hsla(var(--bg-color-hsl), .9);--bg-color-light:hsl(var(--bg-color-h), var(--bg-color-s), calc(var(--bg-color-l) / .9));--bg-color-dark:hsl(var(--bg-color-h), var(--bg-color-s), calc(var(--bg-color-l) * .9));--code-color-h:calc(var(--link-color-h) + 20);--code-color-s:calc(var(--link-color-s) * .2 + 30%);--code-color-l:var(--link-color-l);--code-color-hsl:var(--code-color-h),var(--code-color-s),var(--code-color-l);--code-color:hsl(var(--code-color-hsl));--code-color-0:hsla(var(--code-color-hsl), 0);--code-color-3:hsla(var(--code-color-hsl), .03);--code-color-5:hsla(var(--code-color-hsl), .05);--code-color-7:hsla(var(--code-color-hsl), .07);--code-color-10:hsla(var(--code-color-hsl), .1);--code-color-20:hsla(var(--code-color-hsl), .2);--code-color-30:hsla(var(--code-color-hsl), .3);--code-color-40:hsla(var(--code-color-hsl), .4);--code-color-50:hsla(var(--code-color-hsl), .5);--code-color-60:hsla(var(--code-color-hsl), .6);--code-color-70:hsla(var(--code-color-hsl), .7);--code-color-80:hsla(var(--code-color-hsl), .8);--code-color-90:hsla(var(--code-color-hsl), .9);--code-color-light:hsl(var(--code-color-h), var(--code-color-s), calc(var(--code-color-l) / .9));--code-color-dark:hsl(var(--code-color-h), var(--code-color-s), calc(var(--code-color-l) * .9))}:root{--link-color:#E06C75;--bg-color:#1E2127;--text-color:#ABB2BF;--code-color:#61AFEF}</style> <link rel="canonical" href="https://ezral.net/Dataquest-guided-project-3.html"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous"> <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-171083170-1"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-171083170-1")</script> <meta property="og:type" content="article"> <meta property="og:site_name" content="Ezral"> <meta property="og:title" content="Spam Filter with Naive Bayes"> <meta property="og:url" content="https://ezral.net/Dataquest-guided-project-3.html"> <meta property="og:description" content="This is a Dataquest guided project originally written on this jupyter notebook file Background Have you ever felt disturbed by spam messages? I’m sure everybody has. Even those who sent the spam messages have. Fortunately there’s this thing called spam..."> <meta property="og:image" content="https://ezral.net/logo.png"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@ald_latumahina"> <meta name="twitter:creator" content="@ald_latumahina"> <meta property="article:published_time" content="2020-07-06T00:00:00+00:00"> <meta property="article:modified_time" content="2020-07-12T06:56:28+00:00"> <meta name="twitter:label1" value="Words"> <meta name="twitter:data1" value="4330 words"> <meta name="twitter:label2" value="Reading time"> <meta name="twitter:data2" value="21 mins"> </head><body><nav class="navigation"> <ul> <li> <a href="/about/">About</a> </li> <li> <a href="/">Ezral</a> </li> <li> <a href="/medical/">Medical</a> </li> <li class="current"> <a href="/data/">Data</a> </li> <li> <a href="/news/">Life</a> </li> </ul> </nav> <main class="content" role="main"> <article lang="en"> <header> <h1 title="Spam Filter with Naive Bayes" data-title="Spam Filter with Naive Bayes"> Spam Filter with Naive Bayes<span class="dot dot--post"> </span> </h1> <small> By <span rel="author">Ezral</span> on <time datetime="2020-07-06T00:00:00+00:00">Jul 6, 2020</time> </small> </header> <div class="post-content"> <h6 id="this-is-a-dataquest-guided-project-originally-written-on-this-jupyter-notebook-file">This is a <a href="https://app.dataquest.io/m/433/guided-project%3A-building-a-spam-filter-with-naive-bayes">Dataquest guided project</a> originally written on <a href="https://nbviewer.jupyter.org/github/Ezral/guided_project/blob/master/Building%20a%20Spam%20Filter%20with%20Naive%20Bayes.ipynb">this jupyter notebook file</a></h6> <h2 id="background">Background</h2> <p>Have you ever felt disturbed by spam messages? I’m sure everybody has. Even those who sent the spam messages have. Fortunately there’s this thing called spam filter that helps us avoid the hassle of repeatedly cleaning our inbox. The goal of this exercise is to create a basic messaging spam filter using Naive Bayes theorem. Isn’t this exciting? It sure is.</p> <p>We’ll achieve this goal using a dataset put together by Tiago A. Almeida and José María Gómez Hidalgo that has 5,572 SMS messages made available in <a href="https://archive.ics.uci.edu/ml/datasets/sms+spam+collection">UCI Machine Learning Repository</a>. The messages have been previously classified into spam/ham (not spam) category and can be downloaded from <a href="https://dq-content.s3.amazonaws.com/433/SMSSpamCollection">here</a>. This allows us to “train” the algorithm to classify the messages and later on label whether a certain message is a spam/ham using the following principal:</p> <p>If the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Spam) \cdot \prod_{i=1}^{n}P(w_i|Spam) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> is bigger than <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><msup><mi>m</mi><mi>C</mi></msup><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><msup><mi>m</mi><mi>C</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Spam^C) \cdot \prod_{i=1}^{n}P(w_i|Spam^C) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.141041em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> then it’s a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Spam&nbsp;message</mtext></mrow><annotation encoding="application/x-tex">\text{Spam message} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord text"><span class="mord">Spam&nbsp;message</span></span></span></span></span>.</p> <p>Otherwise, if the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Spam) \cdot \prod_{i=1}^{n}P(w_i|Spam) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> is smaller than the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><msup><mi>m</mi><mi>C</mi></msup><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><msup><mi>m</mi><mi>C</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Spam^C) \cdot \prod_{i=1}^{n}P(w_i|Spam^C) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.141041em;vertical-align:-.29971000000000003em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.804292em"><span style="top:-2.40029em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.29971000000000003em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:.07153em">C</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> then it’s not a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Spam&nbsp;message</mtext></mrow><annotation encoding="application/x-tex"> \text{Spam message} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord text"><span class="mord">Spam&nbsp;message</span></span></span></span></span></p> <p>Now that we’ve covered the basics, let’s start working~</p> <h2 id="content">Content</h2> <ul> <li><a href="#background">Background</a></li> <li><a href="#separating-the-dataset">Loading the dataset</a></li> <li><a href="#separating-the-dataset">Separating the dataset</a></li> <li><a href="#cleaning-the-dataset">Cleaning the dataset</a></li> <li><a href="#creating-word-count-dataset">Creating word count dataset</a></li> <li><a href="#calculating-constants">Calculating constants</a></li> <li><a href="#calculating-parameters">Calculating parameters</a></li> <li><a href="#creating-spam-filter-function">Creating spam filter function</a></li> <li><a href="#measuring-filter-accuracy">Measuring filter accuracy</a></li> <li><a href="#conclusion">Conclusion</a></li> </ul> <hr> <h2 id="loading-the-dataset">Loading the dataset</h2> <p>First we will import the packages that we’ll be using and load the dataset. We’ll also take a quick look at the dataset to familiarize ourselves with the data.</p> <p><code class="language-plaintext highlighter-rouge">in [1]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Importing packages for data management
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>    <span class="c1"># Importing pandas
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>     <span class="c1"># Importing numpy
</span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>  <span class="c1"># Importing datetime
</span><span class="kn">import</span> <span class="nn">re</span>              <span class="c1"># Importing regular expression
</span><span class="kn">import</span> <span class="nn">warnings</span>        <span class="c1"># To suppress warning alert
</span><span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>
<span class="c1">#Change setting to avoid dataframe from truncating
</span><span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">max_colwidth</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">display</span><span class="p">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1"># Displaying all output from code cell. Default value = 'last_expr'.
</span><span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="p">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s">"all"</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [2]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># loading the dataset
</span><span class="n">sms</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"SMSSpamCollection"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">'Label'</span><span class="p">,</span><span class="s">'spam_sms'</span><span class="p">])</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [3]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Shape and proportion of the dataset
</span><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">SMSSpamCollection dataset has {} rows and {} columns"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">sms</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sms</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">sms</span><span class="p">[</span><span class="s">'Label'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [3]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    SMSSpamCollection dataset has 5572 rows and 2 columns

    ham     86.593683
    spam    13.406317
    Name: Label, dtype: float64
</code></pre></div></div> <p><a href="#background">Back to top</a></p> <hr> <h2 id="separating-the-dataset">Separating the dataset</h2> <p>To create the spam filter we will need to split the dataset into 2, one for training purpose and the other one for the spam filter testing. The dataset will be split into 80:20 proportion, the larger one being the training dataset that will “teach” our algorithm to recognize spam messages.</p> <p>Here’s where the pre-labelled message will come into play. Basically we’ll have the algorithm calculate and store probability for every single words in the dataset, letting it know which words are more probable to be used in spam and which words are not.</p> <p>Since we have this 5,572 rows of messages, we’ll split them into two sets, 80% for training and 20% for testing.</p> <p><code class="language-plaintext highlighter-rouge">in [4]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Randomizing the dataset
</span><span class="n">random_set</span> <span class="o">=</span> <span class="n">sms</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculating the index for split
</span><span class="n">random_index</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">random_set</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Splitting the dataset
</span><span class="n">training</span> <span class="o">=</span> <span class="n">random_set</span><span class="p">[:</span><span class="n">random_index</span><span class="p">].</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">random_set</span><span class="p">[</span><span class="n">random_index</span><span class="p">:].</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Checking shape and label proportion for training dataset
</span><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Training dataset has {} rows."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">training</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">training</span><span class="p">[</span><span class="s">'Label'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>

<span class="c1"># Checking shape and label proportion for test dataset
</span><span class="k">print</span><span class="p">(</span><span class="s">"Test dataset has {} rows."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">test</span><span class="p">[</span><span class="s">'Label'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [4]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Training dataset has 4458 rows.
    ham     86.54105
    spam    13.45895
    Name: Label, dtype: float64

    Test dataset has 1114 rows.
    ham     86.804309
    spam    13.195691
    Name: Label, dtype: float64
</code></pre></div></div> <p>We’ve split them nicely and it looks like the proportion between the two is similar, which is good.</p> <hr> <h2 id="cleaning-the-dataset">Cleaning the dataset</h2> <p>Up next, tidying the dataset. We’ll clean the words by removing any punctuation and have all the words in lower case.</p> <p><code class="language-plaintext highlighter-rouge">in [5]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Changing to lower case and replacing all punctuation
</span><span class="k">def</span> <span class="nf">clean_punctuation</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\W'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">]</span> <span class="o">=</span> <span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">clean_punctuation</span><span class="p">)</span>
</code></pre></div></div> <hr> <h2 id="creating-word-count-dataset">Creating word count dataset</h2> <p>To count the words, we need to split the words in the messages. By performing a split we’d be creating series containing lists that we can iterate to obtain the vocabulary frequency.</p> <p><code class="language-plaintext highlighter-rouge">in [5]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Transforming messages in SMS column into list
</span><span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">]</span> <span class="o">=</span> <span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [6]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating vocabulary from the SMS column
</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
            <span class="n">vocabulary</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
</code></pre></div></div> <p>The for loop function in the above should prevent any duplicate in the vocabulary list. Quick check to confirm that there’s no duplicate:</p> <p><code class="language-plaintext highlighter-rouge">in [7]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [7]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    True
    7783
</code></pre></div></div> <p>The check returns <code class="language-plaintext highlighter-rouge">True</code>, meaning there’s no duplicated words and the vocabulary has 7,873 unique words in it.</p> <p>Now we can move on to the next step, which is counting the number of times a certain word is used and storing them into a dataframe. This dataframe will later be concatenated with training dataframe to complete the process.</p> <p><code class="language-plaintext highlighter-rouge">in [8]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating word count per sms dictionary
</span><span class="n">word_counts_per_sms</span> <span class="o">=</span> <span class="p">{</span><span class="n">unique_word</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">])</span> <span class="k">for</span> <span class="n">unique_word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>

<span class="c1"># For loop function to fill the dictionary
</span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sms</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">training</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sms</span><span class="p">:</span>
        <span class="n">word_counts_per_sms</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [9]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating word count dataframe and concatenating it with training dataframe
</span><span class="n">word_count_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_counts_per_sms</span><span class="p">)</span>
<span class="n">training_set</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">training</span><span class="p">,</span><span class="n">word_count_data</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p>By having this we can obtain the frequency of a word on a certain label and subsequently calculate the probability of that particular word given spam or ham.</p> <p><a href="#background">Back to top</a></p> <hr> <h2 id="calculating-constants">Calculating constants</h2> <p>Calculating <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(Spam)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>H</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(Ham)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N_{Spam}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.328331em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>H</mi><mi>a</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N_{Ham}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.08125em">H</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>V</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N_{Vocabulary}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span></p> <p><code class="language-plaintext highlighter-rouge">in [10]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Calculating the constants
</span><span class="n">p_ham</span><span class="o">=</span><span class="n">training_set</span><span class="p">[</span><span class="s">'Label'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p_spam</span><span class="o">=</span><span class="n">training_set</span><span class="p">[</span><span class="s">'Label'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Function to count n of words
</span><span class="k">def</span> <span class="nf">word_counter</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="s">'''Function takes in a series
    of strings that will append
    it to a list and return the
    len to complete the word count
    '''</span>
    <span class="n">result</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">word</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">result</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># Number of words in vocabulary, ham and spam
</span><span class="n">n_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
<span class="n">n_ham</span> <span class="o">=</span> <span class="n">word_counter</span><span class="p">(</span><span class="n">training_set</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="s">"Label=='ham'"</span><span class="p">)[</span><span class="s">'spam_sms'</span><span class="p">])</span>
<span class="n">n_spam</span> <span class="o">=</span> <span class="n">word_counter</span><span class="p">(</span><span class="n">training_set</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="s">"Label=='spam'"</span><span class="p">)[</span><span class="s">'spam_sms'</span><span class="p">])</span>

<span class="c1"># Laplace smoothing
</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div> <p><a href="#background">Back to top</a></p> <hr> <h2 id="calculating-parameters">Calculating parameters</h2> <p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(w_{i} | Spam)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>H</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(w_{i} | Ham)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span> that will be used to classify the incoming message are called <em>parameters</em>. They will be calculated using the following equations:</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi></mrow></msub><mo>+</mo><mi>α</mi></mrow><mrow><msub><mi>N</mi><mrow><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi></mrow></msub><mo>+</mo><msub><mi>N</mi><mrow><mi>V</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi><mi>y</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex"> P(w_{i} | Spam) = \frac{N_{w_{i}|Spam}+ \alpha}{N_{Spam} + N_{Vocabulary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.400638em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4285299999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.328331em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7451999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.02691em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:.05764em">S</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>H</mi><mi>a</mi><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>N</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>H</mi><mi>a</mi><mi>m</mi></mrow></msub><mo>+</mo><mi>α</mi></mrow><mrow><msub><mi>N</mi><mrow><mi>H</mi><mi>a</mi><mi>m</mi></mrow></msub><mo>+</mo><msub><mi>N</mi><mrow><mi>V</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi><mi>y</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex"> P(w_{i} | Ham) = \frac{N_{w_{i}|Ham}+ \alpha}{N_{Ham} + N_{Vocabulary}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.400638em;vertical-align:-.972108em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4285299999999999em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.08125em">H</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3361079999999999em"><span style="top:-2.5500000000000003em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.22222em">V</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight" style="margin-right:.01968em">l</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:.02778em">r</span><span class="mord mathdefault mtight" style="margin-right:.03588em">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.7451999999999996em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.34480000000000005em"><span style="top:-2.5198em;margin-left:-.10903em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:-.02691em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mathdefault mtight" style="margin-right:.08125em">H</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.3551999999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathdefault" style="margin-right:.0037em">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.972108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p> <p><code class="language-plaintext highlighter-rouge">in [11]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Separating spam/ham messages
</span><span class="n">spam_msg</span> <span class="o">=</span> <span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span><span class="p">[</span><span class="s">'Label'</span><span class="p">]</span><span class="o">==</span><span class="s">'spam'</span><span class="p">]</span>
<span class="n">ham_msg</span> <span class="o">=</span> <span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span><span class="p">[</span><span class="s">'Label'</span><span class="p">]</span><span class="o">==</span><span class="s">'ham'</span><span class="p">]</span>

<span class="c1"># Creating 2 dictionaries for parameters
</span><span class="n">parameters_spam</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>
<span class="n">parameters_ham</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [12]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Calculating parameters:
</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocabulary</span><span class="p">:</span>
    <span class="n">n_word_given_spam</span> <span class="o">=</span> <span class="n">spam_msg</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>   
    <span class="n">p_word_given_spam</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_spam</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_spam</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">n_vocab</span><span class="p">)</span>
    <span class="n">parameters_spam</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_spam</span>

    <span class="n">n_word_given_ham</span> <span class="o">=</span> <span class="n">ham_msg</span><span class="p">[</span><span class="n">word</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">p_word_given_ham</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_word_given_ham</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_ham</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">n_vocab</span><span class="p">)</span>
    <span class="n">parameters_ham</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_word_given_ham</span>
</code></pre></div></div> <p><a href="#background">Back to top</a></p> <hr> <h2 id="creating-spam-filter-function">Creating spam filter function</h2> <p>The spam filter works by comparing the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>S</mi><mi>p</mi><mi>a</mi><mi>m</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Spam | Message)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.05764em">S</span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>H</mi><mi>a</mi><mi>m</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> P(Ham | Message)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathdefault" style="margin-right:.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:.08125em">H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:.10903em">M</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:.03588em">g</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span> and assigning spam/ham label depending on which one has the larger proportion. To do this we’ll use the following function:</p> <p><code class="language-plaintext highlighter-rouge">in [13]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Spam filter function
</span><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">prob</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">init_value</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">init_value</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">*=</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'\W'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>

    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">prob</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameters_spam</span><span class="p">,</span> <span class="n">p_spam</span><span class="p">)</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">prob</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameters_ham</span><span class="p">,</span> <span class="n">p_ham</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'P(Spam|message):'</span><span class="p">,</span> <span class="n">p_spam_given_message</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'P(Ham|message):'</span><span class="p">,</span> <span class="n">p_ham_given_message</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Label: Ham'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">p_ham_given_message</span> <span class="o">&lt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Label: Spam'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Equal proabilities, have a human classify this!'</span><span class="p">)</span>
</code></pre></div></div> <p>Testing the <code class="language-plaintext highlighter-rouge">classify</code> function using a message that’s clearly a spam:</p> <p><code class="language-plaintext highlighter-rouge">in [14]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">classify</span><span class="p">(</span><span class="s">'WINNER!! This is the secret code to unlock the money: C3421.'</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [14]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    P(Spam|message): 1.3481290211300841e-25
    P(Ham|message): 1.9368049028589875e-27
    Label: Spam
</code></pre></div></div> <p>and using a message that’s a ham:</p> <p><code class="language-plaintext highlighter-rouge">in [15]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">classify</span><span class="p">(</span><span class="s">"Sounds good, Tom, then see u there"</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [15]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    P(Spam|message): 2.4372375665888117e-25
    P(Ham|message): 3.687530435009238e-21
    Label: Ham
</code></pre></div></div> <p>This shows that the function is working properly and we can apply it to the test set that we haven’t touched yet. We’ll do that while measuring the filter accuracy.</p> <p><a href="#background">Back to top</a></p> <hr> <h2 id="measuring-filter-accuracy">Measuring filter accuracy</h2> <p>To do this, we will compare the set that was not included in the training set, which is the test set, and compare the label given by the filter with the label that comes with the dataset, which is done by human. We’ll adjust the <code class="language-plaintext highlighter-rouge">classify</code> function in the above to return a value instead of printing them so we can apply it to create a new column.</p> <p><code class="language-plaintext highlighter-rouge">in [16]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Function to test the filter function
</span><span class="k">def</span> <span class="nf">classify_test_set</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[\W]'</span><span class="p">,</span><span class="s">' '</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">"[\s]"</span><span class="p">,</span><span class="n">message</span><span class="p">)</span>
    <span class="n">p_spam_given_message</span> <span class="o">=</span> <span class="n">prob</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameters_spam</span><span class="p">,</span> <span class="n">p_spam</span><span class="p">)</span>
    <span class="n">p_ham_given_message</span> <span class="o">=</span> <span class="n">prob</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">parameters_ham</span><span class="p">,</span> <span class="n">p_ham</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_ham_given_message</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'ham'</span>
    <span class="k">elif</span> <span class="n">p_ham_given_message</span> <span class="o">&lt;</span> <span class="n">p_spam_given_message</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'spam'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'Equal proabilities, have a human classify this!'</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">in [17]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Applying the function
</span><span class="n">test</span><span class="p">[</span><span class="s">'predicted'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'spam_sms'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">classify_test_set</span><span class="p">)</span>
</code></pre></div></div> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathsize="0.9em"><mtext>Accuracy</mtext><mo>=</mo><mfrac><mtext>number&nbsp;of&nbsp;correctly&nbsp;classified&nbsp;messages</mtext><mtext>total&nbsp;number&nbsp;of&nbsp;classifed&nbsp;messages</mtext></mfrac></mstyle></mrow><annotation encoding="application/x-tex"> \small \text{Accuracy} = \frac{\text{number of correctly classified messages}}{\text{total number of classifed messages}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7899930000000001em;vertical-align:-.174996em"></span><span class="mord text sizing reset-size6 size5"><span class="mord">Accuracy</span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel sizing reset-size6 size5">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0266919999999997em;vertical-align:-.7923960000000001em"></span><span class="mord sizing reset-size6 size5"><span class="mopen nulldelimiter sizing reset-size5 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">total&nbsp;number&nbsp;of&nbsp;classifed&nbsp;messages</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord">number&nbsp;of&nbsp;correctly&nbsp;classified&nbsp;messages</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size5 size6"></span></span></span></span></span></span> The applied function works as expected. Next we’ll do the calculation in the above on the dataset by using this for loop function below that will print the numbers:</p> <p><code class="language-plaintext highlighter-rouge">in [18]:</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Measuring accuracy value
</span><span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'Label'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">val_1</span><span class="p">,</span> <span class="n">val_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'Label'</span><span class="p">],</span><span class="n">test</span><span class="p">[</span><span class="s">'predicted'</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">val_1</span> <span class="o">==</span> <span class="n">val_2</span><span class="p">:</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Accuracy value of the spam filter is {}%."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">correct</span><span class="o">/</span><span class="n">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of correct label: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">correct</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of incorrect label: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">correct</span><span class="p">))</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">out [18]:</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Accuracy value of the spam filter is 98.74326750448833%.
    Number of correct label: 1100
    Number of incorrect label: 14
</code></pre></div></div> <hr> <h2 id="conclusion">Conclusion</h2> <p>In conclusion, it’s a really worthwhile project that helped me understand the application of Bayes theorem and see how a simple spam filter that uses statistics works. It would be interesting to see how we might be able to increase the accuracy further by modifying the algorithm.</p> <p><a href="#background">Back to top</a></p> <hr> <footer class="post-modified-date"> <p> Updated <time datetime=" 2020-07-12T06:56:28+08:00 "> Sunday, Jul 12, 2020 </time> </p> </footer> </div> </article> </main> <footer class="footer"> <ul> </ul> </footer> <script></script> <script></script> <script>"serviceWorker"in navigator&&"ezral.net"===window.location.hostname&&navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)}).catch(function(e){console.log("ServiceWorker registration failed: ",e)})</script> <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-171083170-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script> <script async="" src="https://www.google-analytics.com/analytics.js"></script></body></html>